# Redis
## scanning
* nmap -Pn -v 10.10.10.3 -p6379 -sV --script=redis-info
* nc -nv 10.10.10.3 6379 (kapcsolodik e... kb ennyi a lenyeg)
* redis-cli -h 10.10.10.3
  * (ha nem talalja a rendszer, akkor sudo apt install redis-tools)
* (redis-cli)# info
  * ha ezt irja -NOAUTH Authentication required. akkor authentikaciora van szukseg
## credentials
* hogyha hozzaferunk a redis.conf file-hoz akkor lehet hogy van benne usernev es jelszo (a jelszo lehet rendes vagy temporary jelszo)
  * masteruser -> username mezo
  * requirepass -> jelszo mezo
* ha nincs 'masteruser', akkor a usernev fixen 'default'
* minden nem kikommentelt sor keresese redis config fajlban
  * cat ./redis.conf | grep -P '^[^#].*'
* kivulrol nem lehet kideriteni, hogy adtak e meg usernevet masikat vagy a 'default' a usernev
  * csak akkor tudjuk, hogyha hozzaferunk a config fajlhoz
## bruteforcing password
* nmap -Pn -v 10.10.10.3 -p6379 -sV --script=redis-brute
* nmap -Pn -v 10.10.10.3 -p6379 -sV --script=redis-brute --script-args=userdb=./users.txt,passdb=./passwords.txt
* msf module...
* etc
## login with valid credentials
* ha kell megadni usernevet
<pre>
 $ redis-cli -h 10.10.10.3
 redis-cli# AUTH username password
 +OK
</pre>
* ha nincs usernev, vagyis a usernev a 'default' mert nem lett a config fajlban implementalva
  * akkor usernev nelkul kell authentikalni
<pre>
 $ redis-cli -h 10.10.10.3
 redis-cli# AUTH password
 +OK
</pre>
## server enumeration after successfull login (credentials needed) (or anonymous access needed)
* most important commands
<pre>
 redis-cli# INFO
 redis-cli# client list
 redis-cli# CONFIG GET * (ket sorba tordeli a key value parokat)
 redis-cli# monitor (monitoring requests)
 redis-cli# slowlog get 25 (get the top 25 slowest queries)
</pre>
* all commands
  * https://redis.io/docs/data-types/
  * https://lzone.de/cheat-sheet/Redis
  * https://lzone.de/cheat-sheet/Redis
* commands can be disabled and command names can be modified with alias
  * it can be done in the config file
  * modifying commands (e.g. FLUSHDB)
    * rename-command FLUSHDB "NEWFLUSHDB"
  * disable commands (e.g. FLUSHDB)
    * rename-command FLUSHDB ""
## database enumeration
<pre>
 INFO keyspace (list databases)
 SELECT 1 (select nth database, indexed from 0)
 KEYS * (list keys of selected database)
 GET key_name (view specified record)
</pre>
## source
* https://book.hacktricks.xyz/network-services-pentesting/6379-pentesting-redis
