# powershell
## list all .txt file in folder and subfolders
Get-ChildItem -Recurse -File -Name -Filter '*.txt'
## count of .txt files in folder and subfolders
(Get-ChildItem -Recurse -File -Name -Include *.txt).Length
## search string in file
howto megkeresese egy yml file-ban
Get-Content 'test.txt' | Select-String -AllMatches -CaseSensitive 'abcd'
## search string in .txt files in folder and subfolder
Get-ChildItem -Recurse -File -Filter '*.txt' | Get-Content | Select-String -AllMatches -CaseSensitive 'abcd'
## replace string in .txt files in folder and subfolders
Get-ChildItem -Recurse -File -Filter '*.txt' | ForEach-Object {(Get-Content $_).Replace(“abcd”,”efgh")}
## file editing script for merging files (just for syntax example)
<code>
$start="`r`n    FROM EXCEL:`r`n    “;
$start2="`r`n    FROM EXCEL2:`r`n    “;
$end="`r`n    -----------`r`n    “;
$end2="`r`n    -----------`r`n    “;
$OFS=“`r`n    ”;
Get-ChildItem -Path ".\" -Recurse -File -Filter '*.yml' | ForEach-Object {
$id=($_.Name).Replace(".yml",""); 
$excel=((Get-Content "C:\Users\test\input.txt" | Select-String -CaseSensitive $id) -replace '^[A-Z].*\^', ‘’);
$to_replace=“howto: |”;
if($excel){$to_replace=$to_replace+$start+$excel+$end};
$error.Clear();
$html=(Get-Content ("C:\Users\test\guides\"+($_.Name).Replace(".yml","").Split("\")[-1]+".html") -ErrorAction SilentlyContinue);
if(!$error) { $to_replace=$to_replace+$start2+$html+$end2 };
if(($excel) -or (!$error)) {(Get-Content $_.FullName).Replace(“howto: |",$to_replace) | Set-Content $_.FullName}
}
</code>
