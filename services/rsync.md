# Rsync
## info
* common port: 873/tcp
* rsync is a utility for efficiently transferring and synchronizing files between a computer and an external hard drive and across networked computers by comparing the modification times and sizes of files. It is commonly found on Unix-like operating systems. The rsync algorithm is a type of delta encoding, and is used for minimizing network usage. Zlib may be used for additional data compression, and SSH or stunnel can be used for security.
## enumeration
### Banner and manual communication
<pre>
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy        	
NAS_Public     	
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
</pre>
### Enumerate shared folders
* An rsync module is essentially a directory share. These modules can optionally be protected by a password. This options lists the available modules and, optionally, determines if the module requires a password to access**:**
* nmap -Pn -v 10.10.10.3 -p873 -sV --script=rsync-list-modules
* nmap -Pn -v 10.10.10.3 -p873 -sV --script=rsync-brute --script-args=userdb=./userlist.txt,passdb=./passlist.txt
* msf6> use auxiliary/scanner/rsync/modules_list
<pre>
#Example using IPv6 and a different port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
</pre>
* Notice that it could be configured a shared name to not be listed. So there could be something hidden.
Notice that it may be some shared names being listed where you need some (different) credentials to access. So, not always all the listed names are going to be accessible and you will notice it if you receive an "Access Denied" message when trying to access some of those.
### Manual rsync
* Once you have the list of modules you have a few different options depending on the actions you want to take and whether or not authentication is required. If authentication is not required you can list a shared folder.   * And copy all files to your local machine via the following command.
<pre>
#list shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name
#copy contents
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
</pre>

## source
* https://book.hacktricks.xyz/network-services-pentesting/873-pentesting-rsync
