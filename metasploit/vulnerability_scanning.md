# vulnerability scanning with metasploit
## importing nmap scan results into msf
* $ nmap ... -oX nmap_output_xml
* msf6> db_import ./nmap_output_xml
## vuln scanning with msf
* msf6> db_nmap
* msf6> use axiliary/scanner/portscan/tcp
* msf6> hosts
* msf6> services
* msf6> search type:expoloit name:<specific_service_name_or_version>
  * if short description did not mention exact service version
  * msf6> use exploit/.../<module_name>
  * msf6> info
  * check the description for service versions
* $ searchsploit <specific_service_name_or_version>
### metasploit-autopwn plugin
* source: https://github.com/hahwul/metasploit-autopwn
* needs msf database (services command output)
* $ wget https://raw.githubusercontent.com/hahwul/metasploit-autopwn/master/db_autopwn.rb
* $ sudo cp db_autopwn.rb /usr/share/metasploit-framework/plugins/db_autopwn.rb
* msf6> load db_autopwn
* msf6> db_autopwn (print help)
* msf6> db_autopwn -p -t -PI 445
  * -p select modules based on open ports
  * -t show all matchine exploit modules)
  * -PI 445 only exploit hosts with given ports open
  * automatically list matching exploits
* now we should check manually the exact OS version
* and googling the known vulnerabilites and exploits of that version
* and then utilize those exploits in msf (if presented)
### msf analyze command
* info
  * analyzes the msf database content -> hosts, services
  * gives us hints on exploits regarding the host+service presented in the database
  * show us if credentials are required or not
* steps
  * msf6> analyze
  * msf6> vulns
    * shows us identified vulnerabilites
## import nessus scan results into msf
